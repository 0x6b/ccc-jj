[generator]
# Claude CLI configuration for commit message generation
command = "claude"
# Claude CLI arguments - using headless mode with structured JSON output
args = ["-p", "--output-format", "json", "--no-session-persistence"]
# Fallback message if generation fails
default_commit_message = "chore: update changes"

[bookmark]
# Prompt template for generating bookmark names from commit summaries
# Variables: {commit_summaries}
prompt_template = """
Generate a short, descriptive bookmark (branch) name for the following commits.

Rules:
- Use 2-6 lowercase words separated by hyphens (e.g., "add-user-auth", "fix-login-redirect")
- Each word segment MUST start with a letter, NOT a digit (e.g., "v2-support" not "2-support")
- Do NOT include version numbers as separate segments (e.g., "update-parser" not "update-parser-0-11-0")
- Focus on the single most significant change - do NOT try to cover all changes
- Be specific but concise
- Do NOT use dates, ticket numbers, or generic names like "update-code"
- Do NOT use prefixes like "feature/", "fix/", etc.

Commits:
{commit_summaries}

OUTPUT ONLY THE BOOKMARK NAME. NO EXPLANATIONS.
"""

[diff]
# Files with more changed lines than this threshold are collapsed to a summary
# Helps avoid exceeding LLM context limits with large file changes
max_diff_lines = 2048
# Files with diff larger than this byte size are collapsed to a summary
# Catches edge cases like large SVGs or minified files with few lines
max_diff_bytes = 65535

# Total diff size limits - abort before sending to Claude if exceeded
# Prevents wasted API calls and cryptic failures on massive diffs
max_total_diff_lines = 8192
max_total_diff_bytes = 262144  # 256 KB

# Files matching these patterns show summary only (not full diff)
# Useful for large generated/vendored files that add noise
collapse_patterns = [
  # Lock files
  "*.lock",
  "package-lock.json",
  "yarn.lock",
  "pnpm-lock.yaml",
  "composer.lock",
  "Gemfile.lock",
  "poetry.lock",
  "Pipfile.lock",
  "flake.lock",
  # Minified/bundled
  "*.min.js",
  "*.min.css",
  "*.bundle.js",
  "*.chunk.js",
  # Generated code
  "*.generated.*",
  "*.pb.go",
  "*.pb.rs",
  "*_generated.rs",
  # Vendored
  "vendor/**",
  "node_modules/**",
  "third_party/**",
]

[prompt]
# A prompt template for generating commit messages
# Variables to be replaced at run time: {language}, {diff_content}
template = """
Generate a Conventional Commit message in {language} for the following diff.

Conventional Commits Format:
<type>: <description>

[optional body]

[optional footer(s)]

Types: feat, fix, refactor, docs, test, chore, style, perf, build, ci

Guidelines:
- Title: 50 characters max, imperative mood ("add feature" not "added feature")
    - Do NOT include scope or component in parentheses
    - Prioritize: feat > fix > refactor > others
    - If multiple types, choose the most significant one
- Body: explain WHY the change was needed (motivation, context), not WHAT changed
    - Include body only if motivation/context isn't obvious from the title
    - Use bullet points for multiple changes or breaking changes
    - For breaking changes, explain migration path in footer with "BREAKING CHANGE:" prefix

OUTPUT ONLY THE COMMIT MESSAGE. NO EXPLANATIONS, NO COMMENTARY, NO MARKDOWN CODE BLOCKS.

Diff:

{diff_content}
"""
